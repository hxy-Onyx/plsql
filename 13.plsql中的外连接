-- 创建员工表 (employees)
CREATE TABLE employees (
    employee_id INT PRIMARY KEY,          -- 员工ID，主键
    employee_name VARCHAR2(20),           -- 员工姓名
    department_id INT,                    -- 部门ID
    salary INT                            -- 员工薪水
);

-- 创建部门表 (departments)
CREATE TABLE departments (
    department_id INT PRIMARY KEY,        -- 部门ID，主键
    department_name VARCHAR2(20)          -- 部门名称
);

-- 插入数据到员工表
INSERT INTO employees (employee_id, employee_name, department_id, salary) VALUES (1,'Alice',10,7000);
INSERT INTO employees (employee_id, employee_name, department_id, salary) VALUES (2,'Bob',20,6000);
INSERT INTO employees (employee_id, employee_name, department_id, salary) VALUES (3,'Charlie',10,5500);
INSERT INTO employees (employee_id, employee_name, department_id, salary) VALUES (4,'Diana',30,6200);
INSERT INTO employees (employee_id, employee_name, department_id, salary) VALUES (5,'Eve',20,5800);
INSERT INTO employees (employee_id, employee_name, salary) VALUES (6, 'John Doe', NULL, 5000);

-- 插入数据到部门表
INSERT INTO departments (department_id, department_name) VALUES (10,'Engineering');
INSERT INTO departments (department_id, department_name) VALUES (20,'Sales');
INSERT INTO departments (department_id, department_name) VALUES (30,'HR');
INSERT INTO departments (department_id, department_name) VALUES (40,'Marketing');

1.左外连接
BEGIN
    -- 执行左外连接查询
    DBMS_OUTPUT.PUT_LINE('Left Join (LEFT JOIN):');
    FOR rec IN (SELECT e.employee_id, e.employee_name, e.salary, d.department_name
                FROM employees e
                LEFT JOIN departments d
                ON e.department_id = d.department_id) 
    LOOP
        DBMS_OUTPUT.PUT_LINE('Employee: ' || rec.employee_name || ', Salary: ' || rec.salary || ', Department: ' || NVL(rec.department_name, 'No Department'));
    END LOOP;
END;

2.右外连接
BEGIN
    -- 执行右外连接查询
    DBMS_OUTPUT.PUT_LINE('Right Join (RIGHT JOIN):');
    FOR rec IN (SELECT e.employee_id, e.employee_name, e.salary, d.department_name
                FROM employees e
                RIGHT JOIN departments d
                ON e.department_id = d.department_id) 
    LOOP
        DBMS_OUTPUT.PUT_LINE('Employee: ' || NVL(rec.employee_name, 'No Employee') || ', Salary: ' || NVL(TO_CHAR(rec.salary), 'No Salary') || ', Department: ' || rec.department_name);
    END LOOP;
END;

3.全外连接
BEGIN
    -- 执行全外连接查询
    DBMS_OUTPUT.PUT_LINE('Full Outer Join (FULL OUTER JOIN):');
    FOR rec IN (SELECT e.employee_id, e.employee_name, e.salary, d.department_name
                FROM employees e
                FULL OUTER JOIN departments d
                ON e.department_id = d.department_id) 
    LOOP
        DBMS_OUTPUT.PUT_LINE('Employee: ' || NVL(rec.employee_name, 'No Employee') || ', Salary: ' || NVL(TO_CHAR(rec.salary), 'No Salary') || ', Department: ' || NVL(rec.department_name, 'No Department'));
    END LOOP;
END;


